集群基本信息预先确认项
---------------------------------------------------------------------------
1. 硬件基本信息
   
   * 节点硬件架构 
      - 示例： AMD64 GPU，intelx86-CPU，ARM64-NPU

   * 设备数量
      - 示例：单机，同构多机，异构多机

   * 关键资源配置（NPU,GPU，网卡）
      - 路由器配置   <需支持DNS Maping, DHCP Server，IP-MAC-Band>
      - 交换机配置   <100G, 10G, 流控，自适应>
      - 每个节点（node）资源配置：<芯片数量>
      - 每个节点依赖资源：
         + 网卡：   <驱动版本，支持接口数>
         + 网络接口：<名称，IP配置>

2. <span id="sysenv">操作系统、驱动和组件版本 </span>
   * 主机操作系统：  <Ubuntu 18.04.1>
   * Docker 版本：  <19.03.12, build 48a6621>
   * k8s 版本：     <v1.18.0>
   * Mysql Server:  <8.0.20 (mysql Ver 14.14 Distrib 5.7.30)>
   * 容器系统和版本：<Ubuntu 18.04>
   * Python:        <3.7.5>
   * 芯片驱动：
      - Nvidia GPU：<xxxxxx>
      - Huawei NPU: <C73B035>
   * 网卡驱动：      <TM210网卡驱动 v1.0.1>

网络预先确认项
---------------------------------------------------------------------------

1. <span id="checklist">预先确认网络配置清单 </span>


   | 序号 |         类目         |   确认信息                                                            |  备注                                   |
   |:----|:--------------------|:-----------------------------------------------------------------------|:---------------------------------------|
   |   1  |       网络限制       | 内网or互联网：<br>互联网带宽：                                          | 　                                     |
   |   2  |          GPU         | 服务器OS：<br>GPU板卡型号： <br>驱动版本：                              | 　                                     |
   |   3  |          NPU         | 服务器OS： <br>NPU驱动版本：                                           | HUAWEI   Ascend910                     |
   |   4  |        交换机        | 交换机型号：<br>交换机带宽：                                            | 1GE   or 10GE      或更高               |
   |   5  |       网关配置       | DHCP-Server：<br>DNS Local Maping：<br>IP-MAC绑定：                    | 　                                      |
   |   6  |       网络配置       | 集群各服务器通信网段：<br>服务器hostname：<br>域名解析<公网访问域名，私网通信域名>： | 　                             |
   |   7  |       网络端口       | 端口开放<80,443,22,30000~32767>：                                      | 　                                      |
   |   8  |      存储服务器      | 容量： <br>NFS or Ceph：                                               | 单独的服务器还是复用集群服务器中的存储     |
   |   9  | 集群各服务器配置信息  | Master节点配置：<br>GPU服务器配置：                                     | 为了保障集群稳定及易维护性，Master节点建议采用通用服务器（物理机），非VM |
   |  10  |     安装/镜像源     | 是否需要私有docker镜像库：<br>是否可访问阿里云/华为云源<Ubuntu/Python>：  | 　                                      | 	


2. 组网规划

   **节点组网规划**
   | 主机名       | 公网IP        | mask        | gateway       |DNS            |iBMC公网IP     |私网IP         |
   |:----------- |:--------------|:------------|:--------------|:--------------|:--------------|:--------------|
   | node01     |xxx.xxx.xxx.xxx|255.255.255.0|xxx.xxx.xxx.xxx|114.114.114.114|xxx.xxx.xxx.xxx|xxx.xxx.xxx.xxx|
   | node02     |xxx.xxx.xxx.xxx|255.255.255.0|xxx.xxx.xxx.xxx|114.114.114.114|xxx.xxx.xxx.xxx|xxx.xxx.xxx.xxx|
   | node03     |xxx.xxx.xxx.xxx|255.255.255.0|xxx.xxx.xxx.xxx|114.114.114.114|xxx.xxx.xxx.xxx|xxx.xxx.xxx.xxx|

   **特殊资源（NPU）组网规划：**
   | node   | npu_id | address       | netmask       |
   |--------|--------|---------------|---------------|
   | node01 | NPU0   | 192.168.10.11 | 255.255.255.0 |
   | node01 | NPU1   | 192.168.20.11 | 255.255.255.0 |
   | node01 | NPU2   | 192.168.30.11 | 255.255.255.0 |
   | node01 | NPU3   | 192.168.40.11 | 255.255.255.0 |
   | node01 | NPU4   | 192.168.10.12 | 255.255.255.0 |
   | node01 | NPU5   | 192.168.20.12 | 255.255.255.0 |
   | node01 | NPU6   | 192.168.30.12 | 255.255.255.0 |
   | node01 | NPU7   | 192.168.40.12 | 255.255.255.0 |
   | node02 | NPU0   | 192.168.10.21 | 255.255.255.0 |
   | node02 | NPU1   | 192.168.20.21 | 255.255.255.0 |
   | node02 | NPU2   | 192.168.30.21 | 255.255.255.0 |
   | node02 | NPU3   | 192.168.40.21 | 255.255.255.0 |
   | node02 | NPU4   | 192.168.10.22 | 255.255.255.0 |
   | node02 | NPU5   | 192.168.20.22 | 255.255.255.0 |
   | node02 | NPU6   | 192.168.30.22 | 255.255.255.0 |
   | node02 | NPU7   | 192.168.40.22 | 255.255.255.0 |

2. 网络拓扑

   ![集群整体组网](satic/node集群拓扑图.png)

部署确认项
---------------------------------------------------------------------------
1. 基础网络配置，参考部署文档

   * 各节点机器主机名（hostname）
   * 资源节点（GPU,NPU,CPU,TPU）接入交换机局域网配置，流控配置
   * 节点接入交换机局域网配置
   * 本地域名解析配置
   * 公网域名解析配置
   * 路由网关或接入网关的DHCP Server，IP-MAC绑定配置
   * 路由网关或接入网关的DNS Local Maping配置

2. 集群和平台部署项

   * 更新集群配置
   * 配置通用账号和同步访问证书
   * 安装初始化系统依赖
   * 安装kubeadm
   * 初始化 k8s
   * 加入k8s 节点
   * 生成平台配置
   * 编译和启用平台服务组件pod

3. 集群状态检查

   * k8s 集群状态
   * k8s 节点状态
   * 平台服务组件pod状态
   * 关键资源（NPU,GPU）状态
   * 平台外网访问状态
   * 节点资源空闲状态
   * 存储使用率
   * 主要业务流 (VC->vc Status->Submit Job->Job List->Job Status->Job Debug)

